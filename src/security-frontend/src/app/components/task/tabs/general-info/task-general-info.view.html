<div>
    <div class="row">
        <div class="col-md-12">
            <div class="form-group " crm-input-validation>
                <label for="task-name">Name</label>
                <input id="task-name" type="text" name="taskName" class="form-control" ng-model="vm.task.name" required ng-readonly="!vm.canEdit">
                <span ng-show="taskForm.taskName.$dirty && taskForm.taskName.$error.required" class="help-block">Task name is required</span>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="form-group" crm-input-validation>
                <label for="task-location">Location</label>
                <input id="task-location" type="text" name="taskLocation" class="form-control" ng-model="vm.task.location" ng-maxlength="500" ng-readonly="!vm.canEdit">
                <span ng-show="taskForm.taskName.$dirty && taskForm.taskName.$error.required" class="help-block">Task location is required</span>
            </div>
        </div>
    </div>
    <div class="row">
        <div ng-show="vm.canEdit" class="col-md-1">
            <div class="form-group">
                <label for="timeless">Timeless</label>
                <input id="timeless" type="checkbox" class="timeless" ng-change="vm.onTimeless()" ng-model="vm.timeless" value="Timeless">
            </div>
        </div>
        <div ng-class="vm.canEdit ? 'col-md-11' : 'col-md-12'">
            <div class="row datetime-group">
                <div class="col-md-6">
                    <crm-date-time-picker model="vm.task.startDate" label="Start date/time" onchange="vm.onStartDateTimeChange(newValue, isDate)" is-edit="vm.canEditDateTime"></crm-date-time-picker>
                </div>
                <div class="col-md-6">
                    <crm-date-time-picker model="vm.task.endDate" label="End date/time" onchange="vm.onEndDateTimeChange(newValue, isDate)" is-edit="vm.canEditDateTime"></crm-date-time-picker>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6 form-group">
            <label for="task-status">Status</label>
            <select id="task-status" class="form-control" ng-model="vm.task.status" ng-disabled="!vm.canEdit"
                    ng-options="x as x.name for x in vm.statuses track by x.id"></select>
        </div>
        <div class="col-md-6 form-group">
            <label for="task-priority">Priority</label>
            <select id="task-priority" class="form-control" ng-model="vm.task.priority" ng-disabled="!vm.canEdit"
                    ng-options="x as x.name for x in vm.priorities track by x.id"></select>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 form-group">
            <label for="task-assignee">Assignee</label>
            <select id="task-assignee" class="form-control" ng-model="vm.task.assignee" ng-disabled="!vm.canEdit"
                    ng-options="x as x | fullName for x in vm.assigns track by x.id"></select>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="form-group">
                <label for="task-description">Details</label>
                <textarea id="task-description" class="form-control" ng-model="vm.task.description" rows="7" ng-maxlength="500"></textarea>
            </div>
        </div>
    </div>
    <div ng-if="vm.task.id">
        <div class="row form-group">
            <div class="col-md-12">
                <div class="panel-group">
                    <strong>Comments ({{vm.task.comments.length}}):</strong>
                    <div class="panel panel-default col-md-12" ng-if="vm.task.comments.length" ng-repeat="comment in vm.task.comments">
                        <div class="row">
                            <h5 class="col-md-6">{{vm.task.assignee.firstName}} {{vm.task.assignee.lastName}}</h5>
                            <h5 class="col-md-6 text-right">{{comment.dateCreated | date: 'hh:mm:ss dd-MM-yyyy'}}</h5>
                        </div>
                        <p class="comment">{{comment.text}}</p>
                    </div>
                    <div class="panel panel-default col-md-12" ng-if="!vm.task.comments.length">
                        <br>
                        <h5 class="text-center">There are no comments for this task</h5>
                        <br>
                    </div>
                </div>
            </div>
        </div>
        <div ng-if="vm.canComment">
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="comment">Leave a comment:</label>
                        <textarea id="comment" class="form-control" ng-model="vm.newComment" rows="3" ng-maxlength="500"></textarea>
                    </div>
                    <button class="btn btn-default col-md-1 pull-right" ng-disabled="!vm.newComment" ng-click="vm.addComment()">Add</button>
                </div>
            </div>
        </div>
    </div>

</div>
